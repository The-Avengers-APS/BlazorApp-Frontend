@inject NavigationManager NavigationManager

<div class="recommended-container">
    <Card Class="recommended-card training-card" @onclick="NavigateToProgram" style="cursor: pointer;">
        <CardBody>
            <div class="card-header-small">
                <Icon Name="IconName.ClipboardCheck" Color="IconColor.Primary" />
                <span class="card-label">@(TodaysPlan.HasActiveProgram ? "Dit program" : "Træningsplan")</span>
            </div>
            <h5 class="plan-name">@TodaysPlan.Name</h5>
            @if (TodaysPlan.HasActiveProgram)
            {
                <div class="plan-progress mb-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <small class="text-muted">Fremgang</small>
                        <small class="text-muted">@TodaysPlan.CompletedExercises / @TodaysPlan.TotalExercises øvelser</small>
                    </div>
                    <Progress Class="progress-sm">
                        <ProgressBar Width="@TodaysPlan.ProgressPercentage" Color="ProgressColor.Success" />
                    </Progress>
                </div>
            }
            else
            {
                <div class="plan-details">
                    <Badge Color="BadgeColor.Light">
                        @TodaysPlan.ExerciseCount øvelser
                    </Badge>
                    @if (TodaysPlan.DurationMinutes > 0)
                    {
                        <Badge Color="BadgeColor.Light">
                            @TodaysPlan.DurationMinutes min
                        </Badge>
                    }
                </div>
            }
        </CardBody>
    </Card>

    <Card Class="recommended-card team-card">
        <CardBody>
            <div class="card-header-small">
                <Icon Name="IconName.PeopleFill" Color="IconColor.Success" />
                <span class="card-label">Næste hold</span>
            </div>
            <h5 class="session-name">@NextSession.Name</h5>
            <div class="session-details">
                <div class="session-time">
                    <Icon Name="IconName.Clock" Size="IconSize.x4" />
                    <span>@NextSession.Time</span>
                </div>
                <Badge Color="BadgeColor.Success">
                    @NextSession.AvailableSpots pladser
                </Badge>
            </div>
        </CardBody>
    </Card>
</div>

@code {
    [Parameter]
    public TrainingPlan TodaysPlan { get; set; } = new();

    [Parameter]
    public TeamSession NextSession { get; set; } = new();

    private void NavigateToProgram()
    {
        if (TodaysPlan.HasActiveProgram && TodaysPlan.ProgramId.HasValue)
        {
            NavigationManager.NavigateTo($"/training/{TodaysPlan.ProgramId}");
        }
        else
        {
            NavigationManager.NavigateTo("/trainingpage");
        }
    }
}
